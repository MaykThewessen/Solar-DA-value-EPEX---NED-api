# Solar DA Value Analysis

This repository analyzes the value of solar PV production in the Netherlands using EPEX spot prices and PV production data from NED.nl. It combines, processes, and visualizes data to provide insights into monthly and yearly PV yield, market value, and profile factors.

## Project Structure

- `combine_v1.py`, `combine_v2.py`, `combine_v3.py`: Scripts for combining and analyzing PV and day-ahead price data. Version 3 is the most advanced and recommended.
- `NED_PV_monthly.py`: Downloads and processes monthly PV production data from NED.nl.
- `EPEX_monthly.py`: Downloads and processes monthly EPEX day-ahead price data.
- `NED.py`: Additional analysis and plotting for solar production.
- `data/`: Contains raw data files, including DA prices and PV production exports.
- `solar_production_plot_v*.html`: Interactive plots generated by the combine scripts.
- `monthly_summary_table.html`: Table summarizing monthly PV and market value metrics.
- `.env`: Environment variables (e.g., API keys).

## How to Use

1. **Install dependencies**  
   Install required Python packages:
   ```sh
   pip install pandas numpy plotly python-dotenv
   ```

2. **Prepare data**  
   - Use `NED_PV_monthly.py` to download PV production data.
   - Use `EPEX_monthly.py` to download EPEX day-ahead prices.
   - Place the resulting CSV files in the `data/` directory.

3. **Run the analysis**  
   Execute the main analysis script:
   ```sh
   python combine_v3.py
   ```
   This will generate:
   - `solar_production_plot_v3.html`: Interactive plot with yearly and monthly summaries.
   - `monthly_summary_table.html`: Table with monthly summary statistics.

4. **View results**  
   Open the generated HTML files in your browser to explore the results.

## Output

- **Interactive Plot**: Shows yearly and monthly PV energy, market value, weighted prices, and profile factors.
- **Summary Table**: Provides a detailed monthly breakdown of PV production, installed capacity, market value, and price metrics.

## Customization

- Update the installed capacity points in `combine_v3.py` as new data becomes available.
- Adjust the scripts to analyze different time periods or add new data sources.

## License

MIT License

---

For questions or contributions, please open an issue or pull request.